@model List<Blog.Models.BlogPost>

@{
    ViewBag.Title = "Manage Posts";
}

<h2>Manage Posts</h2>

<div class="row" ng-app ng-init="posts = [
             @foreach (var post in Model)
             {
                 <text>{PostId: '@post.BlogPostId', Title: '@post.BlogPostTitle.Replace("'", "\\'")', TimeCreated: '@post.TimeCreated.ToString("g")', UserName: '@post.User.UserName', Category: '@post.Category.CategoryTitle', Status: '@post.Status.ToString()'},</text>
             }

     ]">

    <table class="table table-striped">
        <thead>
        <tr>
            <th class="col-xs-1">PostID</th>
            <th class="col-xs-3">Title</th>
            <th class="col-xs-1">User</th>
            <th class="col-xs-2">Time Created</th>
            <th class="col-xs-1">Category</th>
            <th class="col-xs-1">Status</th>
            <th class="col-xs-3"></th>
        </tr>
        <tr>
            <th><input class="form-control" type="text" ng-model="postFilter.PostId"/></th>
            <th><input class="form-control" type="text" ng-model="postFilter.Title"/></th>
            <th><input class="form-control" type="text" ng-model="postFilter.User"/></th>
            <th><input class="form-control" type="text" ng-model="postFilter.TimeCreated"/></th>
            <th><input class="form-control" type="text" ng-model="postFilter.Category"/></th>
            <th><input class="form-control" type="text" ng-model="postFilter.Status"/></th>
            <th></th>
        </tr>
        </thead>
        <tbody>
        <tr ng-repeat="post in posts | filter:postFilter">
            <td>{{post.PostId}}</td>
            <td>{{post.Title}}</td>
            <td>{{post.UserName}}</td>
            <td>{{post.TimeCreated}}</td>
            <td>{{post.Category}}</td>
            <td>{{post.Status}}</td>
            <td>
                @{
                    var url1 = Url.Action("ViewBlogPost", "BlogPost", new {id = "{{post.PostId}}"});
                    url1 = HttpUtility.UrlDecode(url1);

                    var url2 = Url.Action("ApprovePost", "BlogPost", new {id = "{{post.PostId}}"});
                    url2 = HttpUtility.UrlDecode(url2);

                    var url3 = Url.Action("DenyPost", "BlogPost", new {id = "{{post.PostId}}"});
                    url3 = HttpUtility.UrlDecode(url3);

                    var url4 = Url.Action("DeletePost", "BlogPost", new {id = "{{post.PostId}}"});
                    url4 = HttpUtility.UrlDecode(url4);
                }
                @{

                }
                <a href="@url2" class="btn btn-success"><span class="glyphicon glyphicon-check"></span></a>
                <a href="@url3" class="btn btn-warning"><span class="glyphicon glyphicon-ban-circle"></span></a>
                <a href="@url4" class="btn btn-danger"><span class="glyphicon glyphicon-remove"></span></a>
                <a href="@url1" class="btn btn-info">Details</a>
            </td>
        </tr>
        </tbody>
    </table>
</div>

@section scripts
{
    <script src="~/Scripts/angular.min.js"></script>
}